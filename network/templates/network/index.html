{% extends "network/layout.html" %}
{% load static %}

{% block body %}

    {% if user.is_authenticated and 'make_post' in meta.components_to_show %}
        <div>
            <form method="post" action="{% url 'post' %}">
                {% csrf_token %}
                <Label for="post">New Post</Label>
                <textarea id="post" name="post"></textarea>
                <input type="submit" value="Post" />
            </form>
        </div>
    {% endif %}


    {% if 'profile' in meta.components_to_show %}
        <div>
    
            <div>
                <strong><span id="following">{{ meta.count_user_follows|default:0 }}</span></strong> Following &nbsp;&nbsp;&nbsp;&nbsp;
                <strong><span id="followers">{{ meta.followers_count|default:0  }}</span></strong> Followers
            </div>
            
            {% if user.is_authenticated and user != meta.profile_user %}
                <div>
                    <a href="{% url 'follow' meta.profile_user.username %}" type="button" class="btn btn-outline-dark" id="follow_toggle">
                        {% if meta.follows_user %}
                            Unfollow
                        {% else %}
                            Follow
                        {% endif %}
                    </a>
                </div>
            {% endif %}

        </div>
    {% endif %}

    
    {% if 'posts' in meta.components_to_show %}
        {% for post in posts %}

            <div>
                <a href="{% url 'profile' post.user.username %}">{{post.user}}</a><br/>
                {{post.post}}<br/>
                {{post.timestamp}}<br/>

                {% if not user.is_authenticated or not post.id in user_likes %}
                    <img src="{% static 'network/img/translike.png' %}" data-postid="{{post.id}}" width="20px" height="20px" class="btn_like"  /><span class="likes">{{post.likes.count}}</span><br/><br/><br/>
                {% else %}
                    <img src="{% static 'network/img/red.png' %}" data-postid="{{post.id}}" width="20px" height="20px" class="btn_like" /><span class="likes">{{post.likes.count}}</span><br/><br/><br/>
                {% endif %}
            </div>

            {% empty %}
                <br/><br/><br/><h2>No posts to display. Follow other users to see their posts.</h2>

        {% endfor %}
    {% endif %}

    <!-- Modal -->
    <div class="modal fade" id="loginModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLongTitle">Login</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form action="{% url 'login' %}" method="post">
                        {% csrf_token %}
                        <div class="form-group">
                            <input autofocus class="form-control" type="text" name="username" placeholder="Username">
                        </div>
                        <div class="form-group">
                            <input class="form-control" type="password" name="password" placeholder="Password">
                        </div>
                        <input class="btn btn-primary" type="submit" value="Login">
                    </form>
                </div>
                <div class="modal-footer">
                    Don't have an account? <a href="{% url 'register' %}">Register here.</a>
                </div>
            </div>
        </div>
    </div>

{% endblock %}

